<!-- Modal Structure -->
<div
  id="modal-File-Upload"
  class="modal border-radius-6 modal-fixed-footer"
  style="
    z-index: 1003;
    display: none;
    opacity: 0;
    top: 4%;
    transform: scaleX(0.8) scaleY(0.8);
  "
>
  <div class="modal-header">
    <span><span class="article-action">Subir</span> Imágen</span>
  </div>

  <div class="modal-content">
    <div class="upload-container">
      <!-- Files Upload Container -->
      <div
        class="upload-inner-container dfc"
        [hidden]="this.previewUrl || this._trackingS.files.length >= 1"
      >
        <div class="upload-content dfc">
          <div
            appDragNDrop
            (onFileDropped)="onFileSelected($event)"
            class="well my-drop-zone dfc"
          >
            <i class="material-icons">cloud_upload</i>
            Arrastrar y soltar archivos aquí
            <span class="file-upload-or" style="color: black;">O</span>
            <div class="input-file-button" style="width: 30%;">
              <ng-container *ngIf="this.idImg !== undefined">
                <button
                  class="waves-effect waves-light btn modal-upload-action"
                  (click)="uploadButton.click()"
                >
                  Buscar
                </button>

                <input
                  #uploadButton
                  name="uploadButton"
                  id="file-upload"
                  type="file"
                  style="display: none;"
                  (change)="onFileSelected($event)"
                  ng2FileSelect
                  [uploader]="this._imgS.uploader"
                />
              </ng-container>

              <ng-container *ngIf="this.idImg === undefined">
                <button
                  class="waves-effect waves-light btn modal-upload-action"
                  (click)="uploadF.click()"
                >
                  Buscar
                </button>
                <input
                  #uploadF
                  name="uploadF"
                  id="file-upload2"
                  type="file"
                  style="display: none;"
                  (change)="onFileSelected($event)"
                  multiple
                />
              </ng-container>
            </div>
          </div>
        </div>
      </div>
      <!-- Files List Container -->
      <div
        *ngIf="this._trackingS.files.length > 0"
        class="files-list-container"
      >
        <!-- File Item -->
        <div
          class="tracking-file-item-container dfr"
          *ngFor="let file of this._trackingS.files; let i = index"
        >
          <div class="tracking-file-item-content dfr">
            <div class="tracking-file-item-image">
              <img
                [src]="
                  file?.data.name.split('.')[1].indexOf('doc') >= 0 ||
                  file?.data.name.split('.')[1].indexOf('docx') >= 0
                    ? '../../../assets/images/word_icon.png'
                    : '../../../assets/images/pdf_icon.png'
                "
                alt=""
              />
            </div>
            <div class="tracking-file-data-and-progress-container dfr">
              <div class="tracking-file-item-data dfc">
                <div class="tracking-file-item-name">
                  <span id="file-label">{{ file?.data.name }}</span>
                </div>
                <div class="tracking-file-item-size">
                  <span id="file-label">{{
                    this.formatBytes(file?.data.size)
                  }}</span>
                </div>
              </div>
              <div class="file-progress-bar-container">
                <app-progress
                  *ngIf="this._trackingS.progressT >= 1"
                  [progress]="this._trackingS.progressT"
                ></app-progress>
              </div>
            </div>

            <div
              class="tracking-file-item-delete dfc waves-effect waves-light"
              (click)="deleteFile(i)"
            >
              <i class="material-icons">close</i>
            </div>
          </div>
        </div>
        <!-- File Add Button -->
        <ng-container>
          <div class="file-add-button-container dfc">
            <button
              class="btn waves-effect waves-light"
              (click)="uploadMoreFiles.click()"
            >
              Agregar más archivos
            </button>
          </div>
          <input
            #uploadMoreFiles
            name="uploadMoreFiles"
            id="upload-more-files"
            type="file"
            style="display: none;"
            (change)="onFileSelected($event.target.files)"
            multiple
          />
        </ng-container>
      </div>
      <!-- Image Preview Container -->
      <div *ngIf="this.previewUrl" class="upload-img-preview centered-img-bg">
        <img [src]="this.previewUrl" />
        <div class="img-delete-button">
          <div
            (click)="deleteImage()"
            class="img-delete waves-effect waves-light dfr"
          >
            <i class="material-icons">close</i>
          </div>
        </div>
        <div class="img-details dfc">
          <div class="top-img-details">
            <div class="img-name">
              {{
                (this.img?.name.split("."))[0] +
                  "." +
                  (this.img?.name.split("."))[1] | uppercase
              }}
            </div>
          </div>
          <div class="bottom-img-details">
            <div class="img-type">
              <i class="material-icons">image</i>
              {{ (this.img?.name.split("."))[1] | uppercase }}
            </div>
            <div class="img-size">
              {{ this.formatBytes(this.img?.size) }}
            </div>
          </div>
          <div class="file-progress-container">
            <!-- *ngIf="this._imgS.uploader.isUploading" -->
            <app-progress
              [progress]="this._imgS.uploader.progress"
            ></app-progress>
          </div>
        </div>
      </div>
      <!-- General Upload Progress Bar -->
      <div class="general-upload-progress-bar">
        <app-progress
        *ngIf="this._trackingS.progressF >= 1"
        [progress]="this._trackingS.progressF"
      ></app-progress>
      </div>
    </div>
  </div>
  <div class="modal-footer modal-actions">
    <button
      (click)="deleteImage()"
      class="modal-close waves-effect waves-light btn modal-close-action perfil-close-action"
      [disabled]="this._trackingS.disableCancelUpload"
    >
      Cancelar
    </button>
    <button
      type="submit"
      (click)="
        this.typeImg !== undefined && this.idImg !== undefined
          ? uploadImg()
          : addDocuments()
      "
      class="waves-effect waves-light btn modal-submit-action"
      [class.button-disabled]="
        this._trackingS.files.length <= 0 && !this.previewUrl
      "
    >
      {{
        this.typeImg !== undefined && this.idImg !== undefined
          ? "Subir"
          : "Agregar"
      }}
    </button>
  </div>
</div>
